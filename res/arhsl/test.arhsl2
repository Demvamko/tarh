#version 330

input {
    ivec2 pos;
    int uvid;
    int ao;
}
0 ivec2 pos;
1 int uvid;
2 int ao;

0 struct camera {
    mat4x4 proj;
    mat4x4 view;
}

3 struct chunk {
    ivec2 cpos;
}

2 struct atlas {
    float uvs[127 * 4];
}

0 sampler2D tex;

vec2 uv;

vert {
    pos += cpos * 16

    uv = vec2(atlas.uvs[uvid], atlas.uvs[uvid + 1]);

    return camera.proj * camera.view * vec4(pos, 1);
}

frag {
    vec4 color = texture(tex, uv);
    color.rgb *= ao;
    return color;
}